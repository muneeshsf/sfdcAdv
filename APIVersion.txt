import os
import csv
import re

def extract_api_version(xml_file):
    try:
        with open(xml_file, 'r') as file:
            content = file.read()
            match = re.search(r'<apiVersion>(.*?)</apiVersion>', content)
            if match:
                return match.group(1)
    except Exception as e:
        print(f"Error parsing {xml_file}: {str(e)}")
    return None

def main():
    with open('MBoutput.csv', 'w', newline='') as csvfile:
        writer = csv.writer(csvfile)
        writer.writerow(['Path', 'API Version'])
        for root, dirs, files in os.walk('.'):
            for file in files:
                if file.endswith('.xml'):
                    xml_file = os.path.join(root, file)
                    api_version = extract_api_version(xml_file)
                    if api_version is not None:
                        writer.writerow([xml_file, api_version])

if __name__ == '__main__':
    main()
